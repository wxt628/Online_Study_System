# 后端启动与开发环境配置教程

本教程将指导你在本地 Windows 环境下配置和启动成绩管理教学平台的后端服务。

---

## 1. 数据库（MySQL）配置

### 1.1 安装 MySQL
- 推荐版本：MySQL 8.0 及以上
- 下载地址：https://dev.mysql.com/downloads/installer/

### 1.2 创建数据库并导入表结构
1. **启动 MySQL 服务**。
2. **设置账户密码**：
   - 默认建议使用：
     - 用户名：`root`
     - 密码：`123456`
   - 你可以自定义账户和密码，但需同步修改后端配置（见下文）。
3. **新建数据库**（如：`course_management`）：
   ```sql
   CREATE DATABASE course_management DEFAULT CHARACTER SET utf8mb4;
   ```
4. **导入表结构**：
   - 使用 MySQL Workbench、Navicat 或命令行工具，运行 `BuildDatabase.sql` 文件。
   - 命令行示例：
     ```bash
     mysql -u root -p course_management < BuildDatabase.sql
     ```

---

## 2. Python 环境配置

### 2.1 安装 Python
- 推荐版本：Python 3.9 及以上
- 下载地址：https://www.python.org/downloads/
- 安装时请勾选“Add Python to PATH”

### 2.2 安装依赖包
1. 打开命令行（CMD/PowerShell），进入 `backend` 目录：
   ```bash
   cd d:\resource\projects\Web-Programming-Course-Project\backend
   ```
2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```
   - 若无 `requirements.txt`，可手动安装主要依赖：
     ```bash
     pip install fastapi uvicorn sqlalchemy pymysql python-multipart passlib[bcrypt] python-jose[cryptography] openpyxl
     ```

---

## 3. 配置后端数据库连接

### 3.1 修改数据库账户密码
- 打开 `test.py` 文件，找到类似如下的数据库连接配置：
  ```python
  SQLALCHEMY_DATABASE_URL = "mysql+pymysql://root:123456@localhost:3306/course_management?charset=utf8mb4"
  ```
- 若你自定义了 MySQL 用户名、密码或数据库名，请相应修改此处。
  - 例如：
    ```python
    SQLALCHEMY_DATABASE_URL = "mysql+pymysql://你的用户名:你的密码@localhost:3306/你的数据库名?charset=utf8mb4"
    ```

---

## 4. 启动后端服务

1. 确保 MySQL 服务已启动，且数据库和表结构已导入。
2. 在 `backend` 目录下运行：
   ```bash
   uvicorn test:app --reload
   ```
   - 或使用 Python 命令：
     ```bash
     python -m uvicorn test:app --reload
     ```
3. 访问接口文档：
   - 打开浏览器访问 [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

---

## 5. 常见问题与排查

- **依赖安装失败**：
  - 检查 Python 版本，建议 3.9 及以上。
  - 升级 pip：`python -m pip install --upgrade pip`
- **MySQL 连接失败**：
  - 检查数据库服务是否启动。
  - 检查 `test.py` 中的数据库连接配置是否正确。
  - 检查防火墙设置。
- **表不存在/数据缺失**：
  - 确认已正确导入 `BuildDatabase.sql`。

---

## 6. 其他建议

- 推荐使用虚拟环境（venv）隔离 Python 依赖。
- 如需重置数据库，可重新运行 `BuildDatabase.sql`。
- 如需批量导入学生/成绩，参考 API 文档相关接口说明。

---

如有疑问请查阅 README.md 或联系开发者。